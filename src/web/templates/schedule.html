{% extends "base.html" %}
{% set active = "schedule" %}
{% block title %}Schedule â€” NBA Predictor{% endblock %}

{% block content %}
<h1 class="section-header">NBA Schedule</h1>

<!-- Date Range Picker -->
<div class="card search-card mb-4">
    <form method="get" action="/schedule" class="inline-form">
        <div class="form-group">
            <label class="text-xs text-muted">From</label>
            <input type="date" name="start_date" value="{{ start_date }}" class="date-input">
        </div>
        <div class="form-group">
            <label class="text-xs text-muted">Days</label>
            <select name="days" class="date-input">
                <option value="7" {% if days == 7 %}selected{% endif %}>7 days</option>
                <option value="14" {% if days == 14 %}selected{% endif %}>14 days</option>
                <option value="30" {% if days == 30 %}selected{% endif %}>30 days</option>
                <option value="60" {% if days == 60 %}selected{% endif %}>60 days</option>
            </select>
        </div>
        <button type="submit" class="btn btn-outline btn-sm">Apply</button>
    </form>
</div>

{% if schedule %}
{% set ns = namespace(current_date='') %}
{% for g in schedule %}
    {% if g.get('game_date', '') != ns.current_date %}
        {% set ns.current_date = g.get('game_date', '') %}
        <div class="schedule-date">{{ ns.current_date }}</div>
    {% endif %}
    <div class="card schedule-card">
        <div class="flex items-center justify-between">
            <div class="flex items-center gap-2">
                {% if g.get('away_team_id') %}
                <img src="/images/logos/{{ g.away_team_id }}.svg" class="team-logo-xs" alt="{{ g.get('away_team', '') }}" onerror="this.style.display='none'">
                {% endif %}
                <span class="font-bold">{{ g.get('away_team', '???') }}</span>
                <span class="text-muted">@</span>
                <span class="font-bold">{{ g.get('home_team', '???') }}</span>
                {% if g.get('home_team_id') %}
                <img src="/images/logos/{{ g.home_team_id }}.svg" class="team-logo-xs" alt="{{ g.get('home_team', '') }}" onerror="this.style.display='none'">
                {% endif %}
            </div>
            <div class="text-sm text-muted">
                {{ g.get('game_time', '') }}
                {% if g.get('status') == 'Final' %}
                    <span class="badge badge-primary ml-2">
                        {{ g.get('away_score', '') }}-{{ g.get('home_score', '') }}
                    </span>
                {% endif %}
            </div>
            <div class="flex gap-2">
                <a href="/matchups?home_team={{ g.get('home_team_id', '') }}&away_team={{ g.get('away_team_id', '') }}" 
                   class="btn btn-outline btn-sm">Predict</a>
            </div>
        </div>
    </div>
{% endfor %}
{% else %}
<div class="empty-state">
    <div class="icon">ðŸ“…</div>
    <p>No scheduled games for this date range. Sync data or adjust the date range.</p>
</div>
{% endif %}
{% endblock %}
